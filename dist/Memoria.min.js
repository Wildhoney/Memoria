/*! Memoria by Adam Timberlake created on 2013-10-06 */
!function(a,b){"use strict";a.Memoria=function(){"undefined"!=typeof b&&(b.getItem("memoria")||b.setItem("memoria",JSON.stringify({})),this._initialiseForms())},a.Memoria.prototype={_supportedNodes:["input","select","textarea","*[data-memoria-input]"],clear:function(a){var c=JSON.parse(b.memoria);return"undefined"==typeof c[a]?!1:(delete c[a],b.memoria=JSON.stringify(c),void 0)},_initialiseForms:function(){for(var b=a.document.querySelectorAll("form[name]"),c=0,d=b.length;d>c;c++)for(var e=b[c],f=this._fetchInputs(e),g=0,h=f.length;h>g;g++){var i=f[g];if("password"!==i.getAttribute("type")){var j=i.hasAttribute("data-memoria-input"),k=j?"Element":i.nodeName.charAt(0).toUpperCase()+i.nodeName.slice(1).toLowerCase(),l=j?a.Memoria.Element:a.Memoria[k],m={formName:e.getAttribute("name"),nodeName:i.getAttribute("data-memoria-name")||i.getAttribute("name")};if("undefined"==typeof l)throw"MEMORIA: Unable to instantiate `Memoria."+k+"` delegator object.";var n=new l(i,m);n.form=e,n.node=i,n.key=m,j&&n.attachObserver(a.Memoria[i.getAttribute("data-memoria-input")]),n.initialise(),n.transferValue()}}},_fetchInputs:function(a){for(var b=[],c=0,d=this._supportedNodes.length;d>c;c++)for(var e=a.querySelectorAll(this._supportedNodes[c]),f=0,g=e.length;g>f;f++)b.push(e[f]);return b}},a.document.addEventListener("DOMContentLoaded",function(){a.memoria=new a.Memoria},!1)}(window,window.localStorage),function(a,b){"use strict";a.Memoria.Element=function(){},a.Memoria.Element.prototype={node:null,form:null,key:null,observer:null,_attribute:"value",initialise:function(){var a=this.node.getAttribute("data-memoria-event");if(!a)throw"MEMORIA: Unable to automatically find the event name.";this._attachEvent(a)},attachObserver:function(a){this.observer=a},_attachEvent:function(a){if("undefined"==typeof this.node[a])throw"MEMORIA: Unable to find the `"+a+"` event on `"+this.node.nodeName.toLowerCase()+"` node.";this.node[a]=this._save.bind(this)},transferValue:function(){var a=this._getStorage(),b=this.key,c=a[b.formName][b.nodeName];c&&(this.observer&&"function"==typeof this.observer.onRetrieval?this.observer.onRetrieval(this.node,c):this.node[this._attribute]=c)},_save:function(a){if(!this.key.nodeName)throw'Memoria: Attempting to save value "'+this.node[this._attribute]+'" but node does not have a `name`.';var c=this._getStorage(),d=this.key;c[d.formName][d.nodeName]=this.observer&&"function"==typeof this.observer.onEvent?this.observer.onEvent(a,this.node):this.node[this._attribute],b.setItem("memoria",JSON.stringify(c)),this.node.hasAttribute("data-memoria-name")&&this._resetOthersWithSameName()},_getStorage:function(){var a=JSON.parse(b.getItem("memoria"));return"undefined"==typeof a[this.key.formName]&&(a[this.key.formName]={}),a},_getEventName:function(a){return this.node.getAttribute("data-memoria-event")||a},_setAttribute:function(a){this._attribute=a},_resetOthersWithSameName:function(){for(var a=this._getStorage(),c=this.node.getAttribute("name"),d=this.form.querySelectorAll('*[name="'+c+'"]'),e=0,f=d.length;f>e;e++){var g=d[e];if(g!==this.node&&g.hasAttribute("data-memoria-name")){var h=g.getAttribute("data-memoria-name");a[this.key.formName][h]&&(delete a[this.key.formName][h],b.setItem("memoria",JSON.stringify(a)))}}}}}(window,window.localStorage),function(a){"use strict";a.Memoria.Input=function(){},a.Memoria.Input.prototype=new a.Memoria.Element,a.Memoria.Input.prototype.initialise=function(){switch(this.node.getAttribute("type")){case"radio":this._setAttribute("checked"),this._attachEvent(this._getEventName("onclick"));break;case"checkbox":this._setAttribute("checked"),this._attachEvent(this._getEventName("onchange"));break;default:this._attachEvent(this._getEventName("onkeyup"))}}}(window),function(a){"use strict";a.Memoria.Select=function(){},a.Memoria.Select.prototype=new a.Memoria.Element,a.Memoria.Select.prototype.initialise=function(){this._attachEvent(this._getEventName("onchange"))}}(window),function(a){"use strict";a.Memoria.Textarea=function(){},a.Memoria.Textarea.prototype=new a.Memoria.Element,a.Memoria.Textarea.prototype.initialise=function(){this._attachEvent("onkeyup")}}(window);